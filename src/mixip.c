/***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
 * Introduction
 **************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/

/**********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************//**
 * @file      mixip.c
 * 
 * @version   1.0
 *
 * @date      18-05-2025
 *
 * @brief     MIXIP source file.  
 *  
 * @author    Fábio D. Pacheco, 
 * @email     fabio.d.pacheco@inesctec.pt or pacheco.castro.fabio@gmail.com
 *
 * @copyright Copyright (c) [2025] [Fábio D. Pacheco]
 * 
 * @note      Manuals:
 * 
 **************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/

/***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
 * Imported libraries
 **************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/

#include <mixip.h>
#include <errno.h>

/***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
 * Functions
 **************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/

/***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
int8_t 
mixip_halt( flow_t * flow ){
  if( !flow ){
    errno = EINVAL;
    return -1;
  }

  if( flow->network )
    return 0;

  flow->network = 1;
  sem_wait( &flow->rx_done );
  sem_wait( &flow->tx_done );
  return 0;
}

/***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
int8_t 
mixip_continue( flow_t * flow ){
  if( !flow ){
    errno = EINVAL;
    return -1;
  }

  if( !flow->network )
    return 0;

  flow->network = 0;
  sem_post( &flow->rx_wait );
  sem_post( &flow->tx_wait );
  return 0;
}

/***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
 * End file
 **************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
